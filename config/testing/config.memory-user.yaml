# vllm-sr CLI config for Memory Integration Test
# This is the user-facing vllm-sr format

version: v0.1

# Listeners - Network configuration (required)
listeners:
  - name: "http-8888"
    address: "0.0.0.0"
    port: 8888
    timeout: "300s"

# Signals - Domain-based for category auto-generation
signals:
  domains:
    - name: "general"
      description: "General queries for memory testing"
      mmlu_categories: ["other"]
  keywords: []

# Decisions - Simple routing for test (using domain for category auto-gen)
decisions:
  - name: "default_route"
    description: "Default route for memory testing"
    priority: 1
    rules:
      operator: "OR"
      conditions:
        - type: "domain"
          name: "general"
    modelRefs:
      - model: "qwen3"
        use_reasoning: false

# Providers - LLM backend
providers:
  models:
    - name: "qwen3"
      endpoints:
        - name: "llm_katan"
          weight: 1
          endpoint: "host.docker.internal:8000"
          protocol: "http"
  default_model: "qwen3"

# Memory configuration - the key feature being tested
memory:
  enabled: true
  milvus:
    address: "host.docker.internal:19530"
    collection: "memory_test_ci"
    dimension: 384
  embedding:
    model: "all-MiniLM-L6-v2"
    dimension: 384
  default_retrieval_limit: 5
  default_similarity_threshold: 0.70
  query_rewrite:
    enabled: true
    endpoint: "http://host.docker.internal:8000"
    model: "qwen3"
    max_tokens: 100
    timeout_seconds: 30
  extraction:
    enabled: true
    endpoint: "http://host.docker.internal:8000"
    model: "qwen3"
    batch_size: 10
    timeout_seconds: 30
